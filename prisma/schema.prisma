generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

// Actors: Alex, Nastia, Jimmy
model Actor {
  id        String   @id @default(cuid())
  name      String   @unique // "alex", "nastia", "jimmy"
  label     String   // "Alex", "Nastia", "Jimmy"
  type      String   // "human", "ai"
  createdAt DateTime @default(now())
  tasks     Task[]
  workLogs  WorkLog[]
}

// Dynamic tasks - any action
model Task {
  id          String    @id @default(cuid())
  actorId     String
  actor       Actor     @relation(fields: [actorId], references: [id])
  type        String    // "email", "video", "news", "custom", etc.
  title       String
  description String?
  result      String?
  status      String    @default("pending") // pending, in_progress, done, failed
  projectId   String?
  project     Project?  @relation(fields: [projectId], references: [id])
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  completedAt DateTime?
}

// Projects
model Project {
  id          String   @id @default(cuid())
  name        String
  description String?
  progress    Int      @default(0) // 0-100%
  status      String   @default("active") // active, paused, completed
  owner       String   // "alex", "nastia", "jimmy"
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  tasks       Task[]
}

// Work logs - hours tracked
model WorkLog {
  id        String   @id @default(cuid())
  actorId   String
  actor     Actor    @relation(fields: [actorId], references: [id])
  date      DateTime
  hours     Float
  notes     String?
  createdAt DateTime @default(now())
}

// Money tracker
model MoneyEntry {
  id          String   @id @default(cuid())
  amount      Float
  currency    String   @default("CHF")
  type        String   // "income", "expense"
  source      String   // "instagram", "onlyfans", "tradepilot", etc.
  description String?
  date        DateTime @default(now())
  createdAt   DateTime @default(now())
}

// Jimmy's cron executions (visible to Alex)
model CronExecution {
  id        String   @id @default(cuid())
  cronName  String
  startedAt DateTime @default(now())
  endedAt   DateTime?
  status    String   @default("running") // running, success, failed
  result    String?
  error     String?
}

// Schedule entries (for calendar view)
model ScheduleEntry {
  id          String   @id @default(cuid())
  actor       String   // "alex", "nastia", "jimmy"
  title       String
  description String?
  startTime   DateTime
  endTime     DateTime?
  recurring   String?  // "daily", "weekly", "monthly", or null
  dayOfWeek   Int?     // 0-6 for recurring weekly
  createdAt   DateTime @default(now())
}
